<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AvaN0x - Discord</title>
    <link rel="stylesheet" media="screen and (min-width:721px)" href="../style.css" />
    <link rel="stylesheet" media="screen and (max-width:720px)" href="../mobile.css" />
    <meta name="viewport"  content="width=max-device-width, initial-scale=1" />
    <!-- DISCORD -->
    <meta property="og:title" content="AvaN0x - Discord" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://avan0x.github.io/" />
    <meta property="og:image" content="https://avatars3.githubusercontent.com/u/27494805?s=460&v=4" />
    <meta property="og:description" content="Par AvaN0x" />

    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="https://avatars3.githubusercontent.com/u/27494805?s=460&v=4" />

    <script src="https://kit.fontawesome.com/0383df481c.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
  </head>
  <body>
    <div id="menu">
      <script>
        $(function () {
          $("div#menu").load("../menu.html");
        });
      </script>
    </div>
    <div id="cookieAccepter">
      <p></p>
      <input type="submit" value="Accepter les cookies" />
    </div>
    

    <section>
      <h1>Clément - Discord <i class="fab fa-discord"></i></h1>
      <h2>Utilité</h2>
        <p class="text-indent">Ce discord utilise des webhooks pour poster automatiquement les modifications apportées sur mon <a href="https://github.com/AvaN0x">github<i class="fab fa-github" style="display: inline; margin: 0 4px"></i></a>.</p>

      <div id="discordInvite">
        <p>Tu as reçu une invitation à rejoindre un serveur</p>
        <img src="https://avatars3.githubusercontent.com/u/27494805?s=460&v=4"/>
        <div id="discordInviteText">
          <a class="discordInviteHref discordInviteName"></a>
          <p><i class="discordBubble"></i> <strong class="discordAmountOnline"></strong> en ligne</p>
        </div>
        <a class="discordInviteHref joinButton">Rejoindre</a>
      </div>

    </section>
    <footer></footer>
    <script src="../src/cookie.js"></script>
    <script>
        var xmlhttp = new XMLHttpRequest();

        xmlhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            var array = JSON.parse(this.responseText);
            discordJSON(array);
        }
        };
        xmlhttp.open("GET", "https://discordapp.com/api/guilds/673139614927683594/widget.json", true);
        xmlhttp.send();

        function discordJSON(arr) {
          // console.log(arr);

          // for (i = 0; i<arr.members.length; i++) {
          //     console.log(arr.members[i].username)
          // }
          // if (arr.members.length < arr.presence_count)
          //   console.log("Et " + (arr.presence_count - arr.members.length) + " invisibles.");
          

          $("#discordInvite .discordInviteHref").attr("href", arr.instant_invite);
          $("#discordInvite .discordInviteName").html(arr.name);
          $(".discordAmountOnline").html(arr.presence_count);
          
        }
    </script>
  </body>
</html>
